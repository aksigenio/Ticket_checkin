<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∏–ª–µ—Ç–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial; padding: 16px; text-align: center; }
    button { font-size: 18px; padding: 12px 20px; }
    .ok { color: green; }
    .err { color: red; }
  </style>
</head>
<body>

<h2>üéü –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∏–ª–µ—Ç–∞</h2>
<div id="status">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>

<button id="btn" style="display:none">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤—Ö–æ–¥</button>

<script>
const API_URL = 'https://script.google.com/macros/s/AKfycbxOb39M5bPSL8UCsxqYyGkc_iRJ4sAb-dc_kU0Vo1JNXBHi-pqipxbgyJm_FSukb803Ag/exec';

const params = new URLSearchParams(window.location.search);
const token = params.get('token');
const statusDiv = document.getElementById('status');
const btn = document.getElementById('btn');

if (!token) {
  statusDiv.innerHTML = '<span class="err">‚ùå –¢–æ–∫–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</span>';
} else {
  statusDiv.innerHTML = '–ë–∏–ª–µ—Ç –Ω–∞–π–¥–µ–Ω';
  btn.style.display = 'inline-block';
}

btn.onclick = async () => {
  statusDiv.innerText = '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ...';
  btn.disabled = true;

  try {
    const res = await fetch(API_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        type: 'checkin',
        token: token
      })
    });

    const json = await res.json();

    if (json.ok) {
      statusDiv.innerHTML = `<span class="ok">‚úÖ –í—Ö–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω<br>–ú–µ—Å—Ç–æ: ${json.seatId}</span>`;
    } else {
      statusDiv.innerHTML = `<span class="err">‚ùå ${json.error}</span>`;
    }
  } catch (e) {
    statusDiv.innerHTML = '<span class="err">‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏</span>';
  }
};
</script>

</body>
</html>




